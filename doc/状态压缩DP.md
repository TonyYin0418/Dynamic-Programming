## 状态压缩 DP

### 状态压缩

#### 定义

​		状态压缩一般是将一个较小的集合内每个元素的状态通过特定的计算方法，转换为单个整数。这样的转换必须是双射。

​		在信息学竞赛中，状态的压缩和解压缩一般由二进制运算完成。究其主要原因，一方面是因为二进制可以很直接的表达一个元素集合内每个元素选中或不选中的状态，如二进制串 $01001$ 可以表示一个大小为 $5$ 的集合 $S$ 中第 $2$、$5$ 个元素被选中，第 $1$、$3$、$4$ 个元素未被选中的状态。另一方面则是因为计算机在存储数据时是以二进制方式存储，直接在二进制下对数据进行处理和计算往往比其他进制要快的多。**（是不是可以列个数字啥的）**

#### 位运算

在二进制下对数据的处理和计算与数学中常用的加减乘除和逻辑运算略有不同，下面是对几类位运算的定义解释和约定。

* 与（`&`）：$A$ 和 $B$ 的按位与运算中，对 $A$ 和 $B$ 二进制下的每一位的值进行数学中的逻辑与运算，得到结果中对应位的值。

* 或（`|`）：$A$ 和 $B$ 的按位或运算中，对 $A$ 和 $B$ 二进制下的每一位的值进行数学中的逻辑或运算，得到结果中对应位的值。

* 取反（`~`）：$A$ 的按位取反运算中，对 $A$ 二进制下的每一位的值进行数学中的逻辑非运算，得到结果中对应位的值。

* 异或（`^`）：$A$ 和 $B$ 的按位异或计算中，对 $A$ 和 $B$ 二进制下的每一位的值进行如下计算：

  | A    | B    | A $\oplus$ B |
  | ---- | ---- | ------------ |
  | 0    | 0    | 0            |
  | 0    | 1    | 1            |
  | 1    | 0    | 1            |
  | 1    | 1    | 0            |

  得到结果中对应位的值。

* 左移（`<<`），右移（`>>`）：`x<<y` 表示 $x\times 2^y$，`x>>y` 表示 $\frac{x}{2^y}$。

* $A$ 的第 $i$ 位表示 $A$ 在二进制下从最低往最高位数第 $i+1$ 位，即 $\frac{A}{2^i}$ 除以 $2$ 所得余数。

设全集为 $\Omega$，$|\Omega|=n$，用 $n$ 位二进制整数 $x$ 描述 $\Omega$ 的一个子集 $S$，那么 $x$ 的第 $i-1$ 位为 $1$ 则表示 $\Omega$ 中第 $i$ 个元素属于 $S$，为 $0$ 则表示 $\Omega$ 中第 $i$ 个元素不属于 $S$。基于此，对于数学中对集合之间的运算和关系的命题，位运算也有对应计算方式。

* $A$ 与 $B$ 交集：`A&B`
* $A$ 与 $B$ 并集：`A|B`
* $A$ 的补集：`((1<<n)-1)^A`
* $A/B$：`A^(A&B)`
* $p:$ $A$ 是 $B$ 的子集：`(A|B)==B`

### 状态压缩 DP

​		为满足 DP 的无后效性，存储对应值的索引往往需要包括可以描述该阶段状态的全部信息。而对于一类需要记录整个集合内每个元素状态的问题，朴素的对某一数组指针进行中括号运算在程序中略显乏力，设计的状态往往会冗长且转移拖沓，因此状态压缩优化状态就成为了更优的选择。

以一类经典的 NP 问题，旅行商问题（TSP）为例。

#### 状态压缩优化状态设计的应用

互不侵犯（P1896）：

寿司晚宴（P2150）：


